# 아키텍처 분산 필요성 분석

**작성일**: 2026-01-15  
**목적**: 현재 모놀리식 아키텍처의 분산 전환 필요성 평가

---

## ? 현재 아키텍처 분석

### 현재 구조: 모놀리식 (Monolithic)

```
┌─────────────────────────────────────────┐
│     WickedZergBotPro (단일 프로세스)      │
│  ┌───────────────────────────────────┐  │
│  │  EconomyManager                   │  │
│  │  ProductionManager                │  │
│  │  CombatManager                    │  │
│  │  IntelManager (Blackboard)        │  │
│  │  ScoutingSystem                   │  │
│  │  ZergNet (Neural Network)         │  │
│  │  TelemetryLogger                  │  │
│  └───────────────────────────────────┘  │
│           ↓ (동기/비동기 호출)            │
│  ┌───────────────────────────────────┐  │
│  │  StarCraft II Game Engine         │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

**특징**:
- 모든 매니저가 같은 프로세스에서 실행
- 직접 메서드 호출로 통신
- 공유 메모리 (self.bot, self.intel_manager 등)
- 비동기(async/await) 사용하지만 분산은 아님

---

## ? 분산 아키텍처 필요성 평가

### 1. **현재 아키텍처로 충분한 경우**

#### ? 장점 (현재 구조)
1. **낮은 지연시간**: 매니저 간 직접 호출로 지연 거의 없음
2. **단순한 디버깅**: 모든 로직이 한 프로세스에 있어 추적 용이
3. **데이터 일관성**: 공유 메모리로 동기화 문제 없음
4. **게임 루프 최적화**: 실시간 게임에 적합 (프레임 단위 반응)
5. **개발 복잡도 낮음**: 네트워크 통신, 직렬화 등 불필요

#### ?? 현재 구조의 한계
1. **확장성 제한**: 단일 프로세스의 CPU/메모리 한계
2. **장애 격리 부족**: 한 매니저 오류가 전체 봇에 영향
3. **독립적 스케일링 불가**: 특정 매니저만 리소스 증가 불가
4. **다중 게임 동시 실행 어려움**: 프로세스당 1게임

---

### 2. **분산 아키텍처가 필요한 경우**

#### 분산이 유리한 시나리오
1. **대규모 병렬 학습**: 수백 개 게임 동시 실행
2. **클라우드 학습**: 여러 서버에서 분산 학습
3. **독립적 서비스 운영**: 모니터링, 학습, 게임 실행 분리
4. **마이크로서비스 전환**: 각 매니저를 독립 서비스로

#### 분산의 단점
1. **네트워크 지연**: 매니저 간 통신 지연 (게임에 치명적)
2. **복잡도 증가**: 서비스 디스커버리, 로드 밸런싱, 장애 복구
3. **데이터 일관성**: 분산 환경에서 동기화 어려움
4. **디버깅 어려움**: 여러 프로세스 추적 필요
5. **오버헤드**: 직렬화/역직렬화, 네트워크 통신 비용

---

## ? 프로젝트 특성 분석

### StarCraft II 봇의 요구사항

1. **실시간 반응**: 게임 프레임 단위 (약 22.4 FPS)
   - 매니저 간 통신 지연 < 10ms 필요
   - 분산 시 네트워크 지연으로 성능 저하

2. **게임 상태 공유**: 모든 매니저가 동일한 게임 상태 필요
   - 분산 시 상태 동기화 오버헤드
   - 일관성 보장 어려움

3. **단일 게임 인스턴스**: 한 번에 하나의 게임만 실행
   - 분산의 주요 이점(병렬 처리) 활용 어려움

4. **코드 크기**: 141,151줄 (대규모)
   - 모듈화는 되어 있으나 분산은 불필요할 수 있음

---

## ? 권장사항

### 현재는 분산 불필요 (권장)

**이유**:
1. ? **실시간 게임 특성**: 낮은 지연시간이 필수
2. ? **단일 게임 실행**: 병렬 처리 이점 제한적
3. ? **현재 구조로 충분**: 60,000줄 Python 코드가 안정적으로 실행
4. ? **복잡도 증가**: 분산으로 얻는 이점 < 추가 복잡도

### 분산이 필요한 경우 (향후)

다음 상황에서만 분산 고려:

1. **대규모 병렬 학습** (100+ 게임 동시 실행)
   ```
   Game Instance 1 → Manager Service 1
   Game Instance 2 → Manager Service 2
   ...
   Game Instance N → Manager Service N
   ```

2. **클라우드 학습 인프라**
   ```
   Local Bot → Cloud Learning Service
   Local Bot → Cloud Model Training
   ```

3. **독립적 모니터링 서비스**
   ```
   Bot Process → Monitoring Service (별도 서버)
   Bot Process → Dashboard Service (별도 서버)
   ```

---

## ? 현재 아키텍처 개선 방안 (분산 없이)

### 1. **모듈화 강화** (현재 진행 중)
- ? Manager 패턴으로 책임 분리
- ? Blackboard 패턴 (IntelManager)으로 데이터 공유
- ? 인터페이스 분리 (BaseManager)

### 2. **비동기 최적화** (현재 사용 중)
- ? async/await로 동시 처리
- ? 배치 명령 처리

### 3. **에러 격리 강화** (개선 가능)
- ? Dummy Manager로 장애 격리
- ?? 더 강력한 에러 복구 메커니즘 추가 가능

### 4. **성능 모니터링** (현재 구현됨)
- ? TelemetryLogger로 성능 추적
- ? TrainingSessionManager로 통계 관리

---

## ? 결론

### 현재는 분산 아키텍처 불필요

**이유**:
1. **실시간 게임 특성**: 네트워크 지연이 성능에 치명적
2. **단일 게임 실행**: 분산의 주요 이점(병렬 처리) 활용 어려움
3. **현재 구조 충분**: 모듈화된 Manager 패턴으로 유지보수 용이
4. **복잡도 vs 이점**: 분산으로 얻는 이점 < 추가 복잡도

### 향후 분산 고려 시점

다음 조건이 모두 충족될 때만 고려:
- ? 100개 이상 게임 동시 실행 필요
- ? 클라우드 인프라 구축 필요
- ? 독립적 서비스 운영 필요
- ? 네트워크 지연 허용 가능 (게임 외부 서비스)

---

## ? 대안: 하이브리드 아키텍처

게임 실행은 모놀리식 유지, 외부 서비스만 분산:

```
┌─────────────────────────────────────────┐
│  Game Process (Monolithic)              │
│  - 모든 Manager 통합                    │
│  - 실시간 게임 루프                     │
└─────────────────────────────────────────┘
           │
           ├─→ Monitoring Service (분산 가능)
           ├─→ Learning Service (분산 가능)
           └─→ Dashboard Service (분산 가능)
```

**장점**:
- 게임 성능 유지 (낮은 지연)
- 외부 서비스만 확장 가능
- 점진적 분산 가능

---

**최종 권장사항**: ? **현재는 분산 아키텍처 불필요**

현재 모놀리식 구조가 프로젝트 특성에 적합하며, 분산으로 인한 복잡도 증가가 이점보다 큽니다.
